For the water, a mesh region below a height threshold is shaded as animated water instead of land. In the shader, any fragment with pos.z <- -0.15 is treated as water. The waves are simulated by changing the surface normal and texture coordinates as a function of world position and time. Two wave fields are created using sine and cosine functions of x and y with different frequencies. They are combined into a normal vector and this normal is transformed into world space and passed into the same Phong lighting model used for the terrain. A scrolling water texture was also added to add more water detail. Base UVs are computed from the world space x,y coordinates, a flow offset in a fixed direction over time(which creates a drifting effect), and then sampling the texture twice with different warps and a 90 degree rotation. The sampling and rotation blends the texture together so it looks less grid like. The sampled color is color graded between a blue-green and a brighter surface tint. A Fresnel term is added so that grazing angles appear brighter. Finally, the water color is multiplied by the Phong lighting term and blended back toward the base color. This all results in a single mesh plane to represent the water area. 